name: Odoo.sh Deploy
on: [push]
jobs:
  Odoo-SH-Update-All:
    runs-on: ubuntu-latest
    environment: ${{ github.ref_name }}
    steps:
      - name: Update All
        uses: halgandd/odoo-sh-update-all@6e0b22fe09a19ab50801665cde16255c34215dae
        env:
          INSTANCE_NAME: '${{secrets.ODOOSH_INSTANCE_NAME}}'
          PRIVATE_KEY: '${{secrets.SSH_PRIVATE_KEY}}'

  Odoo-SH-Shell:
    needs: Odoo-SH-Update-All
    runs-on: ubuntu-latest
    environment: ${{ github.ref_name }}
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 1
      - name: Odoo Shell Init
        uses: halgandd/odoo-sh-shell@a1beededfa23d164686e4340ad966e8b63b23b1c
        with:
          script: .github/odoo_init.py
        env:
          INSTANCE_NAME: '${{secrets.ODOOSH_INSTANCE_NAME}}'
          PRIVATE_KEY: '${{secrets.SSH_PRIVATE_KEY}}'
      - name: Odoo Shell Install
        uses: halgandd/odoo-sh-shell@a1beededfa23d164686e4340ad966e8b63b23b1c
        with:
          script: .github/odoo_install.py
        env:
          INSTANCE_NAME: '${{secrets.ODOOSH_INSTANCE_NAME}}'
          PRIVATE_KEY: '${{secrets.SSH_PRIVATE_KEY}}'




